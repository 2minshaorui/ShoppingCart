@model ShoppingCart.ViewModels.CartViewModel

@{
    ViewData["Title"] = "View Cart";
    Model.Amount = new List<string>();

    foreach (var item in Model.Cart)
    {
        Model.Amount.Add((item.Product.Price * item.Quantity).ToString("#0.00"));
    }
}

@section Scripts
{
    <script src="~/js/cart/displaycart.js"></script>
}

<div id="header">
    <header>
        <h1>View Cart</h1>
        <link rel="stylesheet" href="~/css/displaycart.css" />
    </header>
    <a href="/Product/DisplayProduct"><u>Continue Shopping</u></a> |
    @if (Model.LoggedIn)
    {
        <a href="/Purchases/DisplayNewPurchases" id="checkout"><u>Checkout</u></a>
    }
    else
    {
        <a href="/Login/Index2" id="checkout"><u>Checkout</u></a>
    }
    <span class="total"><b>Total: $<span id="total_price">@Model.Total</span></b></span>
    @if (Model.LoggedIn)
    {
        <table>
            <tr>
                <td><input id="couponCode" name="couponCode" placeholder="Enter Coupon Code..."/></td>
                <td><input id="validBtn" type="submit" /></td>
            </tr>
            <tr>
                <td colspan="2"><span id="msg" style="font-weight:bold;color:red"></span></td>
            </tr>
        </table>
    }
</div>
<div id="body">
    @if (Model.Total == "0.00")
    {
        <span id="empty" style="display:block">
            <br /><br /><br />
            Your Cart Is Empty
        </span>
    }
    else
    {
        <span id="empty" style="display:none">
            <br /><br /><br />
            Your Cart Is Empty
        </span>
        <br />
        <table>
            @for (int i = 0; i < Model.Cart.Count; i++)
            {
                <tr id=@Model.Cart[i].ProductId>
                    <td>
                        <div class="product_container text-center">
                            @{
                                string link = ViewData["images_prefix"] + Model.Cart[i].Product.Image;
                            }
                            <img src="@link"/>
                            <b>@Model.Cart[i].Product.Title</b>
                            <br />
                            @Model.Cart[i].Product.Description
                        </div>
                    </td>
                    <td>
                        <div class="details">
                            Unit Price: $<span class="price" price_id=@Model.Cart[i].ProductId>@Model.Cart[i].Product.Price</span>
                            <br /><br />
                            Quantity: <input class="quantity" type="number" value=@Model.Cart[i].Quantity min="1" quantity_id=@Model.Cart[i].ProductId>
                            <br /><br />
                            Amount: $<span class="amount" amount_id=@Model.Cart[i].ProductId>@Model.Amount[i]</span>
                        </div>
                    </td>
                    <td><image src="/img/remove_icon.png" class="remove_icon" product_id=@Model.Cart[i].ProductId /></td>
                </tr>
            }
        </table>
    }
</div>